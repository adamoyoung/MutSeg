#!/bin/bash

set -euo pipefail

MALE_LENS=(NaN 21850 25600 21470 22160 20374 17172 17998 18324 9671 12411 13642 13212 11879 9020 7033 7385 5495 8947 4705 6097 3811 2299)
MALE_KS=(NaN 223 261 219 226 208 175 184 187 99 127 139 135 121 92 72 75 56 91 48 62 39 23)
FEMALE_LENS=(NaN 10770 11955 9897 9579 9170 7749 8300 8584 4638 5896 6320 6229 5210 4077 3331 3601 2825 3947 2511 3057 1863 1218)
FEMALE_KS=(NaN 236 262 217 210 201 170 182 188 102 129 139 137 114 89 73 79 62 87 55 67 41 27)
BOTH_LENS=(NaN 32218 37057 30941 31304 29139 24624 25917 26479 14153 18095 19702 19197 16842 12926 10242 10836 8240 12706 7126 9032 5585 3484)
BOTH_KS=(NaN 227, 262, 218, 221, 206, 174, 183, 187, 100, 128, 139, 136, 119, 91, 72, 76, 58, 90, 50, 64 39 25)
SEXES=(male female both)
SEX_ABBREVS=(m f b)
TS=(37 38 40)
CHRM=$1
SEX=$2
DATA_DIR="${HOME}/data/mc_chrms"
RESULTS_DIR="${SCRATCH}/results/${SEXES[$SEX]}"
MP=40

if [ $SEX -eq 0 ]
then LEN=${MALE_LENS[$CHRM]}; K=${MALE_KS[$CHRM]};
fi

if [ $SEX -eq 1 ]
then LEN=${FEMALE_LENS[$CHRM]}; K=${FEMALE_KS[$CHRM]}
fi

if [ $SEX -eq 2 ]
then LEN=${BOTH_LENS[$CHRM]}; K=${BOTH_KS[$CHRM]}
fi


sbatch --nodes=1 --ntasks-per-node=${MP} --time=10:00:00 --job-name=chrm_${CHRM}_${SEX_ABBREVS[$SEX]} --output=${SCRATCH}/outputs/c_${CHRM}_${SEX_ABBREVS[$SEX]}.out --error=${SCRATCH}/outputs/c_${CHRM}_${SEX_ABBREVS[$SEX]}.err --export=DATA_DIR=$DATA_DIR,RESULTS_DIR=$RESULTS_DIR,LEN=$LEN,K=$K,T=${TS[$SEX]},MP=$MP,CHRM=$CHRM,SEX_ABBREV=${SEX_ABBREVS[$SEX]},ALL seg_sbatch.sh